=== 3D Fully Coupled Models
:toc: macro
include::{partialsdir}/header-macros.adoc[]
include::{partialsdir}/header-uri.adoc[]
include::{partialsdir}/mso4sc-uri.adoc[]

Use *MagFull* this app to run simulations of High Field Magnets for:

==== To test the app

To check the app, just change the following values:

* CoupledCartModel

[options="header,footer"]
|===
| Key         | Value                                                            
| *cfgfile*   | `/usr/share/doc/hifimagnet/CoupledCartModel/quarter-torus3D.cfg` 
|===

Aternatively there is an other test:

* `/usr/share/doc/hifimagnet/CoupledCartModel/quarter-torus3D_bmap.cfg` 

==== Prepare your simulation

* provide appropiate configuration, model and materials (see <<here, >> for details)
* create an tar gzipped archive of these files
* upload the data on CKAN  (see <<here, >> for details)

==== Set up the simulation in *Experiments*:
 
[options="header,footer"]
|===
| Key                           | Default                                                            | Notes
| *Dataset resource: input_url* | URL pointing to an archive of data files (comes from the data Catalog) | 
| *Dataset resource: model*     |                                                                    | dataset mode from the data Catalog
| *cfgfile*                     | `quarter-turn3D.cfg`                                               | cfg file need to be in the dataset
| *Output dataset: outputs_at*  |                                                                    | optional
|===


==== Examples and Benchmarks

[options="header,footer"]
|===
| Testcase          | DataSet	                   | HPC settings (partition, ...)                     | Notes
| *quarter-turn*    | `coupled-test`               | lncmi: `stokes`                                   |
|                   |                              | cesga: `thinnodes`                                |
| *Insert H1H4*     | `insert-test`                | lncmi: `stokes`,`n=32`                            | H1H4_cart.cfg
|                   |                              | cesga: `thinnodes`,`144`                          |
| *HL-31*           | hl-31, ressource HL-31.tgz   | lncmi: `stokes`,`n=32`                            | HL-31_cart_boomeramg.cfg
|                   |                              | cesga: `thinnodes`,`144`                          |
| *fullinsert*      | insertfull                   | lncmi: N/A                                        | HL-31-Leads-air_nl_cart_256_json.cfg
|                   |                              | cesga: `thinnodes`,`256`  (not working???         |
|===

